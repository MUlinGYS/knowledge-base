<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>CSS笔记</title>
	<link rel="stylesheet" href="css/general.css" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<style>
	</style>
</head>

<body>
	<div class="head fix" style="background-color: #208C5B;">
		<div class="tt">
			<div class="t2">CSS</div>
			<div class="t3">CSS让你创建好看的网页</div>
		</div>
	</div>
	<div class="content">
		<!-- <div class="box-main" style="margin: 20px 0;"> -->
		<div style="margin: 20px 0;">
			<div class="container" id="card-container-one"
				style="display: flex;justify-content: space-evenly;width: 100%;max-width: 100%;">
				<!-- 卡片将在这里插入 -->
			</div>
		</div>
		<div style="margin: 20px 0;">
			<div class="container" id="card-container-two"
				style="display: flex;justify-content: space-evenly;width: 100%;max-width: 100%;">
				<!-- 卡片将在这里插入 -->
			</div>
		</div>

	</div>

</body>
<!-- 基于canvas绘制的网页背景效果 -->
<script type="text/javascript" src="https://cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js"></script>
<script type="text/javascript" src="./js/jquery.js"></script>
<script>

	window.onload = function () {
		adjustCardDisplay();
		console.log('方法调用');
		window.addEventListener('resize', adjustCardDisplay);
	};

	// 调整卡片显示以适应窗口大小
	function adjustCardDisplay() {
		var windowWidth = window.innerWidth;
		var cardWidth = 250; // 卡片宽度
		var margin = 20; // 卡片间的间距
		var cardsPerRow = Math.floor(windowWidth / (cardWidth + margin));

		$.ajax({
			url: "http://localhost:3000/essay",
			type: "GET",
			dataType: "json",
			success: function (result) {
				var rowIndex = 0;
				var container;
				console.log('方法调用');
				result.data.essays.forEach(function (essay, index) {
					if (index % cardsPerRow === 0) {
						rowIndex++;
						container = document.getElementById('card-container-' + rowIndex);

						if (!container) {
							container = document.createElement('div');
							container.id = 'card-container-' + rowIndex;
							container.className = 'container';
							container.style = 'display: flex;justify-content: space-evenly;width: 100%;max-width: 100%;margin: 20px 0;';
							document.body.appendChild(container);
						}

						// 清除容器中的现有内容
						container.innerHTML = '';
					}

					var card = '<div class="card" style="width: 300px;margin:0 10px;">' +
						'<img class="card-img-top" src="./img/login.gif" alt="Card image">' +
						'<div class="card-body">' +
						'<h4 class="card-title">' + essay.essaysTitle + '</h4>' +
						'<p class="card-text">' + essay.detail + '</p>' +
						'<a href="#" class="btn btn-primary">See Profile</a>' +
						'</div></div>';

					container.innerHTML += card;
				});

				var remainingCards = cardsPerRow - (result.data.essays.length % cardsPerRow);
				if (remainingCards < cardsPerRow) {
					for (var i = 0; i < remainingCards; i++) {
						var placeholder = '<div class="card placeholder" style="width: 300px;margin:0 10px;"></div>';
						container.innerHTML += placeholder;
					}
				}
			},
			error: function () {
				console.log('Send Request Fail..');
			}
		});
	}
</script>
<style>
	/* 占位作用 */
	.placeholder {
		visibility: hidden;
	}
</style>

</html>